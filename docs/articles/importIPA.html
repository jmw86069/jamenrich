<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>How to import and use Ingenuity IPA enrichment data • multienrichjam</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="How to import and use Ingenuity IPA enrichment data">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">multienrichjam</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.16.900</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/importIPA.html">How to import and use Ingenuity IPA enrichment data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jmw86069/multienrichjam">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>How to import and use Ingenuity IPA enrichment data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jmw86069/multienrichjam/blob/master/vignettes/importIPA.Rmd"><code>vignettes/importIPA.Rmd</code></a></small>
      <div class="hidden name"><code>importIPA.Rmd</code></div>

    </div>

    
    
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(multienrichjam);
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(jamba);
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(colorjam);
<span class="kw"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ComplexHeatmap));
<span class="kw"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="st">"stringsAsFactors"</span>=<span class="ot">FALSE</span>, <span class="st">"warn"</span>=<span class="op">-</span><span class="dv">1</span>);
knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(
   <span class="dt">fig.height=</span><span class="dv">10</span>,
   <span class="dt">fig.width=</span><span class="dv">10</span>,
   <span class="dt">fig.align=</span><span class="st">"center"</span>
)</code></pre></div>
<div id="import-and-use-ingenuity-ipa-enrichment-data" class="section level2">
<h2 class="hasAnchor">
<a href="#import-and-use-ingenuity-ipa-enrichment-data" class="anchor"></a>Import and use Ingenuity IPA enrichment data</h2>
<p>This document describes steps recommended for using Ingenuity IPA enrichment data.</p>
<p>Ingenuity IPA enrichment data can be exported using a function <code>"Export All"</code> which by default creates one text file, concatenating each enrichment table into one large file.</p>
<p>This workflow demonstrates the import process using two IPA enrichment files used by Reese et al 2019 <a href="https://doi.org/10.1016/j.jaci.2018.11.043" class="uri">https://doi.org/10.1016/j.jaci.2018.11.043</a> to compare enrichment results in newborns to older children.</p>
<p>It therefore requires IPA enrichment results have already been exported in text format from IPA.</p>
<div id="import-ipa-data-from-text-files" class="section level3">
<h3 class="hasAnchor">
<a href="#import-ipa-data-from-text-files" class="anchor"></a>Import IPA data from text files</h3>
<p>To import an IPA text file, use <code><a href="../reference/importIPAenrichment.html">importIPAenrichment()</a></code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">newborn_txt &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>,
   <span class="st">"Newborns-IPA.txt"</span>,
   <span class="dt">package=</span><span class="st">"multienrichjam"</span>);
newborn_dfl &lt;-<span class="st"> </span><span class="kw"><a href="../reference/importIPAenrichment.html">importIPAenrichment</a></span>(newborn_txt);</code></pre></div>
<p>The result is a list of <code>data.frame</code> objects, where each <code>data.frame</code> represents one enrichment test. A convenient way to see the dimensions of each <code>data.frame</code> is with the function <code><a href="https://rdrr.io/pkg/jamba/man/sdim.html">jamba::sdim()</a></code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/pkg/jamba/man/sdim.html">sdim</a></span>(newborn_dfl);
<span class="co">#&gt;                            rows cols      class</span>
<span class="co">#&gt; Canonical Pathways          113    7 data.frame</span>
<span class="co">#&gt; Upstream Regulators         117    6 data.frame</span>
<span class="co">#&gt; Diseases and Bio Functions  444    7 data.frame</span>
<span class="co">#&gt; Tox Functions                15    7 data.frame</span>
<span class="co">#&gt; Networks                      8    7 data.frame</span>
<span class="co">#&gt; Tox Lists                    19    6 data.frame</span></code></pre></div>
<p>For MultiEnrichMap, we typically want to analyze multiple IPA enrichment files, so we can wrap the call in an <code><a href="https://rdrr.io/r/base/lapply.html">lapply()</a></code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">newborn_txt &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>,
   <span class="st">"Newborns-IPA.txt"</span>,
   <span class="dt">package=</span><span class="st">"multienrichjam"</span>);
olderchildren_txt &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>,
   <span class="st">"OlderChildren-IPA.txt"</span>,
   <span class="dt">package=</span><span class="st">"multienrichjam"</span>);
ipa_files &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">Newborns=</span>newborn_txt,
   <span class="dt">OlderChildren=</span>olderchildren_txt)

ipa_l &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(ipa_files, importIPAenrichment);</code></pre></div>
<p>Now we can check the dimensions within each list using <code><a href="https://rdrr.io/pkg/jamba/man/ssdim.html">jamba::ssdim()</a></code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/pkg/jamba/man/ssdim.html">ssdim</a></span>(ipa_l);
<span class="co">#&gt; $Newborns</span>
<span class="co">#&gt;                            rows cols      class</span>
<span class="co">#&gt; Canonical Pathways          113    7 data.frame</span>
<span class="co">#&gt; Upstream Regulators         117    6 data.frame</span>
<span class="co">#&gt; Diseases and Bio Functions  444    7 data.frame</span>
<span class="co">#&gt; Tox Functions                15    7 data.frame</span>
<span class="co">#&gt; Networks                      8    7 data.frame</span>
<span class="co">#&gt; Tox Lists                    19    6 data.frame</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $OlderChildren</span>
<span class="co">#&gt;                            rows cols      class</span>
<span class="co">#&gt; Canonical Pathways          237    7 data.frame</span>
<span class="co">#&gt; Upstream Regulators         338    7 data.frame</span>
<span class="co">#&gt; Diseases and Bio Functions  500    7 data.frame</span>
<span class="co">#&gt; Tox Functions               118    7 data.frame</span>
<span class="co">#&gt; Networks                     10    7 data.frame</span>
<span class="co">#&gt; Tox Lists                    36    6 data.frame</span></code></pre></div>
<p>In most cases, each IPA file should contain the same enrichment tests, for example <code>"Canonical Pathways"</code>, <code>"Upstream Regulators"</code>, <code>"Diseases and Bio Functions"</code>, etc. However, it is not always the case, so it is recommended to check and verify each IPA file contains at least the enrichment tests needed for downstream analysis.</p>
</div>
<div id="analyze-ipa-enrichments-from-one-enrichment-test" class="section level3">
<h3 class="hasAnchor">
<a href="#analyze-ipa-enrichments-from-one-enrichment-test" class="anchor"></a>Analyze IPA enrichments from one enrichment test</h3>
<p>IPA performs multiple enrichment tests, which are done independently and with unique assumptions and caveats. Therefore, I recommend using one enrichment test at a time in MultiEnrichMap.</p>
<p>Extract one <code>data.frame</code> from each result:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Take only the Ingenuity Canonical Pathways
enrichList_canonical &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(ipa_l, <span class="cf">function</span>(i){
   i[[<span class="st">"Canonical Pathways"</span>]];
});
<span class="kw"><a href="https://rdrr.io/pkg/jamba/man/sdim.html">sdim</a></span>(enrichList_canonical);
<span class="co">#&gt;               rows cols      class</span>
<span class="co">#&gt; Newborns       113    7 data.frame</span>
<span class="co">#&gt; OlderChildren  237    7 data.frame</span>

## Convert data.frame to enrichResult
## multienrichjam::enrichDF2enrichResult
er_canonical &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(enrichList_canonical, <span class="cf">function</span>(i){
   <span class="kw"><a href="../reference/enrichDF2enrichResult.html">enrichDF2enrichResult</a></span>(i,
      <span class="dt">keyColname=</span><span class="st">"Name"</span>,
      <span class="dt">pvalueColname=</span><span class="st">"P-value"</span>,
      <span class="dt">geneColname=</span><span class="st">"geneNames"</span>,
      <span class="dt">geneRatioColname=</span><span class="st">"Ratio"</span>,
      <span class="dt">pvalueCutoff=</span><span class="dv">1</span>)
});
<span class="kw"><a href="https://rdrr.io/pkg/jamba/man/sdim.html">sdim</a></span>(er_canonical);
<span class="co">#&gt;               rows cols        class</span>
<span class="co">#&gt; Newborns       113   10 enrichResult</span>
<span class="co">#&gt; OlderChildren  237   10 enrichResult</span>
<span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(er_canonical[[<span class="dv">1</span>]])));
<span class="co">#&gt;                                                                               ID</span>
<span class="co">#&gt; 1 Role of Macrophages, Fibroblasts and Endothelial Cells in Rheumatoid Arthritis</span>
<span class="co">#&gt; 2                                            Neuroinflammation Signaling Pathway</span>
<span class="co">#&gt; 3                                                      Sirtuin Signaling Pathway</span>
<span class="co">#&gt; 4                                           G-Protein Coupled Receptor Signaling</span>
<span class="co">#&gt; 5                                                 Protein Ubiquitination Pathway</span>
<span class="co">#&gt; 6                                                Signaling by Rho Family GTPases</span>
<span class="co">#&gt;                                                     Ingenuity Canonical Pathways</span>
<span class="co">#&gt; 1 Role of Macrophages, Fibroblasts and Endothelial Cells in Rheumatoid Arthritis</span>
<span class="co">#&gt; 2                                            Neuroinflammation Signaling Pathway</span>
<span class="co">#&gt; 3                                                      Sirtuin Signaling Pathway</span>
<span class="co">#&gt; 4                                           G-Protein Coupled Receptor Signaling</span>
<span class="co">#&gt; 5                                                 Protein Ubiquitination Pathway</span>
<span class="co">#&gt; 6                                                Signaling by Rho Family GTPases</span>
<span class="co">#&gt;   -log(p-value) zScore GeneRatio   geneID    pvalue  p.adjust Count setSize</span>
<span class="co">#&gt; 1         0.405    NaN   0.00321 TNFSF13B 0.3935501 0.3935501     1     312</span>
<span class="co">#&gt; 2         0.406    NaN   0.00322    CASP8 0.3926449 0.3926449     1     311</span>
<span class="co">#&gt; 3         0.428    NaN   0.00344 HIST1H1D 0.3732502 0.3732502     1     291</span>
<span class="co">#&gt; 4         0.447    NaN   0.00362  PRKAR2B 0.3572728 0.3572728     1     276</span>
<span class="co">#&gt; 5         0.461    NaN   0.00377     TAP2 0.3459394 0.3459394     1     265</span>
<span class="co">#&gt; 6         0.478    NaN   0.00397      RDX 0.3326596 0.3326596     1     252</span></code></pre></div>
<div id="run-multienrichmap" class="section level4">
<h4 class="hasAnchor">
<a href="#run-multienrichmap" class="anchor"></a>run multiEnrichMap()</h4>
<p>Now given a list of <code>data.frame</code> results, we can run <code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mem_canonical &lt;-<span class="st"> </span><span class="kw"><a href="../reference/multiEnrichMap.html">multiEnrichMap</a></span>(er_canonical,
   <span class="dt">enrichBaseline=</span><span class="dv">1</span>,
   <span class="dt">cutoffRowMinP=</span><span class="fl">0.05</span>,
   <span class="dt">colorV=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"purple"</span>, <span class="st">"orange"</span>),
   <span class="dt">topEnrichN=</span><span class="dv">20</span>)</code></pre></div>
<p>The output <code>mem_canonical</code> is a list containing various results.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/pkg/jamba/man/sdim.html">sdim</a></span>(mem_canonical);
<span class="co">#&gt;                   rows cols        class</span>
<span class="co">#&gt; enrichLabels         2         character</span>
<span class="co">#&gt; colorV               2         character</span>
<span class="co">#&gt; geneHitList          2              list</span>
<span class="co">#&gt; geneIM              35    2       matrix</span>
<span class="co">#&gt; geneIMcolors        35    2       matrix</span>
<span class="co">#&gt; enrichIMgeneCount   40    2       matrix</span>
<span class="co">#&gt; enrichList           2              list</span>
<span class="co">#&gt; enrichIM            30    2       matrix</span>
<span class="co">#&gt; enrichIMcolors      30    2       matrix</span>
<span class="co">#&gt; multiEnrichDF       30   12   data.frame</span>
<span class="co">#&gt; multiEnrichResult   30   13 enrichResult</span>
<span class="co">#&gt; memIM               34   30       matrix</span>
<span class="co">#&gt; multiEnrichMap      30  220       igraph</span>
<span class="co">#&gt; multiEnrichMap2     30  220       igraph</span>
<span class="co">#&gt; multiCnetPlot       64  110       igraph</span>
<span class="co">#&gt; multiCnetPlot1      64  110       igraph</span>
<span class="co">#&gt; multiCnetPlot1b     64  110       igraph</span>
<span class="co">#&gt; multiCnetPlot2      64  110       igraph</span>
<span class="co">#&gt; colnames             5              list</span></code></pre></div>
</div>
<div id="plot-the-multienrichmap-network" class="section level4">
<h4 class="hasAnchor">
<a href="#plot-the-multienrichmap-network" class="anchor"></a>Plot the MultiEnrichMap network</h4>
<p>For example, we can view the “Multi Enrichment Map” itself. This network connects pathways when they meet a Jaccard overlap coefficient threshold based upon the shared genes between the pathways. The cutoff is defined in <code><a href="../reference/multiEnrichMap.html">multiEnrichMap()</a></code> with argument <code>overlapThreshold=0.1</code>.</p>
<p>The <code>mem_canonical</code> object contains the igraph objects as <code>"multiEnrichMap"</code> for circular nodes, and <code>"multiEnrichMap2"</code> for coloredrectangle, or pie nodes. However, the helper function <code><a href="../reference/mem_multienrichplot.html">mem_multienrichplot()</a></code> is used because it allows more customization, and prints a color legend by default.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">g &lt;-<span class="st"> </span><span class="kw"><a href="../reference/mem_multienrichplot.html">mem_multienrichplot</a></span>(mem_canonical, <span class="dt">repulse=</span><span class="fl">3.5</span>)
<span class="co">#&gt; Registered S3 methods overwritten by 'huge':</span>
<span class="co">#&gt;   method    from   </span>
<span class="co">#&gt;   plot.sim  BDgraph</span>
<span class="co">#&gt;   print.sim BDgraph</span></code></pre></div>
<p><img src="importIPA_files/figure-html/mem_plot_1-1.png" width="960" style="display: block; margin: auto;"></p>
<p>You can custom filter the Jaccard overlap, or try the helper function <code><a href="../reference/mem_find_overlap.html">mem_find_overlap()</a></code> which does pretty well at guessing the best overlap threshold to use, by optimizing the cluster size and total nodes involved.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">g &lt;-<span class="st"> </span><span class="kw"><a href="../reference/mem_multienrichplot.html">mem_multienrichplot</a></span>(mem_canonical,
   <span class="dt">overlap=</span><span class="kw"><a href="../reference/mem_find_overlap.html">mem_find_overlap</a></span>(mem_canonical),
   <span class="dt">repulse=</span><span class="fl">3.5</span>)</code></pre></div>
<p><img src="importIPA_files/figure-html/mem_plot_1b-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Notice there are distinct subnetworks, called “components”, which are not connected to each other. A useful follow-up technique is to graph one component at a time, which we do using the helper function <code><a href="../reference/subset_igraph_components.html">subset_igraph_components()</a></code>. Components are ordered by size, largest to smallest, so you can keep the largest using argument <code>keep=1</code>, or the second largest with <code>keep=2</code>, and so on.</p>
<p>We also call two other helper functions:</p>
<ol style="list-style-type: decimal">
<li>
<code><a href="../reference/removeIgraphBlanks.html">removeIgraphBlanks()</a></code> removes blank colors from multi-color nodes, such as pie nodes, or colored rectangle nodes. It helps show only the remaining colors without the whitespace.</li>
<li>
<code><a href="../reference/relayout_with_qfr.html">relayout_with_qfr()</a></code> applies Fruchterman-Reingold layout to an <code>igraph</code> object. It’s convenient to adjust <code>repulse</code> here, which is the recommended method for adjusting the spacing between nodes. This function also updates other useful attributes such as the node label angle, which makes labels appear offset away from the majority of edges. (It helps more with Cnet plots below.)</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## You can alternatively pull out any other component
g_sub &lt;-<span class="st"> </span><span class="kw"><a href="../reference/subset_igraph_components.html">subset_igraph_components</a></span>(g, <span class="dt">keep=</span><span class="dv">1</span>);

## Re-apply network layout, and remove blank colors
g_sub &lt;-<span class="st"> </span><span class="kw"><a href="../reference/relayout_with_qfr.html">relayout_with_qfr</a></span>(<span class="dt">repulse=</span><span class="fl">3.5</span>,
      <span class="kw"><a href="../reference/removeIgraphBlanks.html">removeIgraphBlanks</a></span>(g_sub))

## Plot
<span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(g_sub, <span class="dt">vertex.size=</span><span class="dv">15</span>)</code></pre></div>
<p><img src="importIPA_files/figure-html/mem_plot_2-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div id="plot-the-enrichment-p-value-matrix" class="section level4">
<h4 class="hasAnchor">
<a href="#plot-the-enrichment-p-value-matrix" class="anchor"></a>Plot the enrichment P-value matrix</h4>
<p>A useful overview of the enrichment results, including the overlaps across datasets, is shown in a heatmap of <code>-log10(Pvalue)</code>. The helper function <code><a href="../reference/mem_enrichment_heatmap.html">mem_enrichment_heatmap()</a></code> is used here.</p>
<p>The argument <code>p_cutoff</code> is used to set the Pvalue below which cells are colorized – every P-value above this threshold is not colored, and displayed as white, even when the P-value is less than 1.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/mem_enrichment_heatmap.html">mem_enrichment_heatmap</a></span>(mem_canonical, <span class="dt">p_cutoff=</span><span class="fl">0.05</span>);</code></pre></div>
<p><img src="importIPA_files/figure-html/enrich_hm-1.png" width="960" style="display: block; margin: auto;"></p>
<p>The argument <code>color_by_column=TRUE</code> will optionally apply a color gradient to each column, using the same P-value threshold defined by <code>p_cutoff</code>. In this case, cells are labeled to indicate the actual enrichment P-value.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/mem_enrichment_heatmap.html">mem_enrichment_heatmap</a></span>(mem_canonical, <span class="dt">color_by_column=</span><span class="ot">TRUE</span>);</code></pre></div>
<p><img src="importIPA_files/figure-html/enrich_hm_2-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div id="plot-the-pathway-gene-incidence-matrix" class="section level4">
<h4 class="hasAnchor">
<a href="#plot-the-pathway-gene-incidence-matrix" class="anchor"></a>Plot the pathway-gene incidence matrix</h4>
<p>We can view the pathway-gene matrix using the function <code><a href="../reference/mem_gene_path_heatmap.html">mem_gene_path_heatmap()</a></code>. This function uses data in the <code>mem</code> object: <code>"memIM"</code> which contains the gene-pathway incidence matrix, <code>"geneIM"</code> which contains the gene-dataset incidence matrix, and <code>"enrichIM"</code> which contains the pathway-dataset matrix.</p>
<p>This function attempts to “guess” a reasonable number of column and row splits – which breaks the column and row dendrograms into separate sub-clusters. These breaks are visual only, but can be useful in follow-up analyses shown later. You can override these numbers with arguments <code>column_split</code> and <code>row_split</code>.</p>
<p>Also, the colors used across the top of the heatmap indicate the enrichment P-value, and are intentionally scaled so all P-values above the P-value threshold are not colored, and are therefore white.</p>
<p>This function uses the amazing <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html">ComplexHeatmap::Heatmap()</a></code> function, which enables many awesome customizable features. The <code>...</code> argument is passed to <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html">ComplexHeatmap::Heatmap()</a></code>, so you can use those features as needed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hm &lt;-<span class="st"> </span><span class="kw"><a href="../reference/mem_gene_path_heatmap.html">mem_gene_path_heatmap</a></span>(mem_canonical);
hm;</code></pre></div>
<p><img src="importIPA_files/figure-html/mem_hm-1.png" width="960" style="display: block; margin: auto;"></p>
<p>As a follow-up analysis, you can pull out each pathway cluster from the heatmap itself, using <code><a href="../reference/heatmap_column_order.html">heatmap_column_order()</a></code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hm_sets &lt;-<span class="st"> </span><span class="kw"><a href="../reference/heatmap_column_order.html">heatmap_column_order</a></span>(hm);
hm_sets;
<span class="co">#&gt; $A</span>
<span class="co">#&gt; [1] "Hepatic Cholestasis"                                    </span>
<span class="co">#&gt; [2] "Dopamine-DARPP32 Feedback in cAMP Signaling"            </span>
<span class="co">#&gt; [3] "α-Adrenergic Signaling"                                 </span>
<span class="co">#&gt; [4] "GPCR-Mediated Nutrient Sensing in Enteroendocrine Cells"</span>
<span class="co">#&gt; [5] "RAR Activation"                                         </span>
<span class="co">#&gt; [6] "eNOS Signaling"                                         </span>
<span class="co">#&gt; [7] "Protein Kinase A Signaling"                             </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $B</span>
<span class="co">#&gt; [1] "Gluconeogenesis I" "Glycolysis I"     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $C</span>
<span class="co">#&gt;  [1] "Fc Epsilon RI Signaling"                                        </span>
<span class="co">#&gt;  [2] "ErbB4 Signaling"                                                </span>
<span class="co">#&gt;  [3] "Fcγ Receptor-mediated Phagocytosis in Macrophages and Monocytes"</span>
<span class="co">#&gt;  [4] "mTOR Signaling"                                                 </span>
<span class="co">#&gt;  [5] "Synaptic Long Term Depression"                                  </span>
<span class="co">#&gt;  [6] "Glioma Signaling"                                               </span>
<span class="co">#&gt;  [7] "Growth Hormone Signaling"                                       </span>
<span class="co">#&gt;  [8] "HIPPO signaling"                                                </span>
<span class="co">#&gt;  [9] "p70S6K Signaling"                                               </span>
<span class="co">#&gt; [10] "ERK5 Signaling"                                                 </span>
<span class="co">#&gt; [11] "Myc Mediated Apoptosis Signaling"                               </span>
<span class="co">#&gt; [12] "Leukocyte Extravasation Signaling"                              </span>
<span class="co">#&gt; [13] "NF-κB Signaling"</span></code></pre></div>
</div>
</div>
<div id="plot-the-pathway-gene-concept-network-cnet-plot" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-the-pathway-gene-concept-network-cnet-plot" class="anchor"></a>Plot the Pathway-Gene Concept network (Cnet plot)</h3>
<p>We can view the Cnet plot (concept network plot) which shows the pathway-gene relationship.</p>
<p>The helper function <code><a href="../reference/memIM2cnet.html">memIM2cnet()</a></code> creates a Cnet plot from the <code>mem_canonical</code> output. Here, we also pipe the result through other helper functions:</p>
<ul>
<li>
<code><a href="../reference/fixSetLabels.html">fixSetLabels()</a></code> applies pathway label word wrap</li>
<li>
<code><a href="../reference/relayout_with_qfr.html">relayout_with_qfr()</a></code> applies network layout and adjusts node labels</li>
<li>
<code><a href="../reference/removeIgraphBlanks.html">removeIgraphBlanks()</a></code> removes blank colors from the <code>igraph</code> nodes</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#cnet &lt;- mem_canonical$multiCnetPlot1b;</span>
cnet &lt;-<span class="st"> </span>mem_canonical <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">   </span><span class="kw"><a href="../reference/memIM2cnet.html">memIM2cnet</a></span>() <span class="op">%&gt;%</span>
<span class="st">   </span><span class="kw"><a href="../reference/fixSetLabels.html">fixSetLabels</a></span>() <span class="op">%&gt;%</span>
<span class="st">   </span><span class="kw"><a href="../reference/removeIgraphBlanks.html">removeIgraphBlanks</a></span>() <span class="op">%&gt;%</span>
<span class="st">   </span><span class="kw"><a href="../reference/relayout_with_qfr.html">relayout_with_qfr</a></span>(<span class="dt">repulse=</span><span class="dv">4</span>);
<span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(cnet, <span class="dt">vertex.label.cex=</span><span class="fl">0.6</span>);
<span class="kw"><a href="../reference/mem_legend.html">mem_legend</a></span>(mem_canonical);</code></pre></div>
<p><img src="importIPA_files/figure-html/cnet_plot_1-1.png" width="960" style="display: block; margin: auto;"></p>
<p>You can extract the largest connected subnetwork to plot, as before.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">g2 &lt;-<span class="st"> </span>cnet;
g2_sub &lt;-<span class="st"> </span><span class="kw"><a href="../reference/subset_igraph_components.html">subset_igraph_components</a></span>(cnet, <span class="dt">keep=</span><span class="dv">1</span>)

<span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(g2_sub);</code></pre></div>
<p><img src="importIPA_files/figure-html/cnet_plot_2-1.png" width="960" style="display: block; margin: auto;"></p>
<div id="customizing-the-cnet-plot" class="section level4">
<h4 class="hasAnchor">
<a href="#customizing-the-cnet-plot" class="anchor"></a>Customizing the Cnet plot</h4>
<p>The most useful customization is to subset the pathway nodes.</p>
<p>One useful method to choose a subset of pathways is to view one heatmap cluster at a time. Here we will use <code>hm_sets</code> made previously.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cnet_sub &lt;-<span class="st"> </span><span class="kw"><a href="../reference/subsetCnetIgraph.html">subsetCnetIgraph</a></span>(cnet,
   <span class="dt">repulse=</span><span class="fl">3.5</span>,
   <span class="dt">includeSets=</span><span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(hm_sets[<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"A"</span>)]));
<span class="kw"><a href="../reference/jam_igraph.html">jam_igraph</a></span>(cnet_sub,
   <span class="dt">node_factor=</span><span class="dv">2</span>,
   <span class="dt">label_dist_factor=</span><span class="dv">3</span>,
   <span class="dt">label_factor=</span><span class="fl">1.3</span>);
<span class="kw"><a href="../reference/mem_legend.html">mem_legend</a></span>(mem_canonical);</code></pre></div>
<p><img src="importIPA_files/figure-html/cnet_plot_1_custom-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div id="subset-the-pathway-gene-cnet-plot" class="section level4">
<h4 class="hasAnchor">
<a href="#subset-the-pathway-gene-cnet-plot" class="anchor"></a>Subset the Pathway-Gene Cnet plot</h4>
<p>You can also subset the Pathway-Gene Cnet plot using specific names, or by some network criteria, using the function <code><a href="../reference/subsetCnetIgraph.html">subsetCnetIgraph()</a></code>.</p>
<p>Pathways are subsetted to require at least 6 genes, using the argument <code>minSetDegree</code>, which can be useful to help simplify the graph structure.</p>
<p>Similarly, the <code>minGeneDegree=2</code> argument can be used to display only genes present in 2 or more pathways, but for now we will not use that argument.</p>
<p>During the subset operation, some convenient default operations are also performed, controlled by function arguments:</p>
<ul>
<li>singlet nodes (with no connection to any other) are removed, <code>remove_singlets=TRUE</code>
</li>
<li>the layout is re-calculated, <code>force_relayout=TRUE</code>
</li>
<li>nodes are re-ordered by color, <code>do_reorder=TRUE</code>
</li>
<li>labels are re-positioned to have proper angle offset away from the edges entering each node, <code>spread_labels=TRUE</code>
</li>
<li>blank colors are not removed from pie and colored rectangle nodes, <code>remove_blanks=FALSE</code>, but can be during this step by <code>remove_blanks=TRUE</code>.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cnet3 &lt;-<span class="st"> </span>multienrichjam<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/multienrichjam/man/subsetCnetIgraph.html">subsetCnetIgraph</a></span>(cnet,
   <span class="dt">repulse=</span><span class="dv">5</span>,
   <span class="dt">minSetDegree=</span><span class="dv">6</span>,
   <span class="dt">minGeneDegree=</span><span class="dv">1</span>);
<span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(cnet3);
<span class="kw"><a href="../reference/mem_legend.html">mem_legend</a></span>(mem_canonical);</code></pre></div>
<p><img src="importIPA_files/figure-html/subnet-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div id="custom-igraph-plot-function-jam_igraph" class="section level4">
<h4 class="hasAnchor">
<a href="#custom-igraph-plot-function-jam_igraph" class="anchor"></a>Custom igraph plot function jam_igraph()</h4>
<p>The <code><a href="../reference/jam_igraph.html">jam_igraph()</a></code> function is a custom version of <code>igraph::plot()</code> intended to enhance the base function in a few ways:</p>
<ul>
<li>argument <code>rescale=FALSE</code> will keep the network layout aspect ratio 1:1, instead of scaling the coordinates to fit the size of the plot window. It also properly scales the node and edge sizes, unlike the base <code>igraph::plot()</code> function.</li>
<li><p>new arguments to help resize existing values:</p></li>
<li>
<code>label_factor</code> re-scales the <code>label.cex</code> values by a multiplier</li>
<li>
<code>node_factor</code>, <code>edge_factor</code> re-scales the <code>node.size</code> and <code>edge.width</code> by a multiplier</li>
<li><p><code>label_dist_factor</code> re-scales the <code>label.dist</code> values by a multiplier</p></li>
</ul>
<p>The function below replicates the previous Cnet plot, with these changes:</p>
<ul>
<li>
<code>node_factor=2</code> makes the nodes 2x larger</li>
<li>
<code>label_factor=1.2</code> makes the <code>label.cex</code> values 1.2x larger</li>
<li>
<code>label_dist_factor=3</code> makes the label distance from the node center 3x larger, which emphasizes the label placement at an angle away from the edges of each node.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/jam_igraph.html">jam_igraph</a></span>(cnet3, <span class="dt">node_factor=</span><span class="dv">2</span>, <span class="dt">label_factor=</span><span class="fl">1.2</span>, <span class="dt">label_dist_factor=</span><span class="dv">3</span>);</code></pre></div>
<p><img src="importIPA_files/figure-html/jam_igraph_1-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#import-and-use-ingenuity-ipa-enrichment-data">Import and use Ingenuity IPA enrichment data</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by James M. Ward.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
